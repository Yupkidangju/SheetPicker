# 교훈 및 회고 (Lessons Learned)

> **최종 갱신일:** 2026-02-17
> **문서 관리:** D3D Protocol §15 (Self Update Rules) 준수

---

## v0.1 BETA 초기화 단계

### 문서 우선 접근법
* **교훈:** D3D Protocol에 따라 문서를 먼저 작성하고 코드를 구현하는 방식이 프로젝트의 방향성을 명확히 하는 데 도움이 됨.
* **적용:** 문서 작성 → 코드 구현 → 문서 동기화 순서를 엄수함으로써 사양 불일치를 최소화.

### 엄격한 규칙 체계
* **교훈:** 파일명 하나, 주석 언어 하나까지 규정된 룰을 따르는 것이 협업 및 유지보수에 중요함을 인지.
* **적용:** `.antigravityrules`에 프로젝트 규칙을 명시하여 에이전트 간 일관성 확보.

---

## v0.1 → v0.3 구현 단계

### 메모리 안전성
* **문제:** 대용량 엑셀 파일 로딩 시 `pandas.read_excel`은 메모리 효율이 좋지 않음.
* **해결:** `openpyxl(read_only=True)`를 사용하여 데이터 스트리밍 방식으로 해결함.
* **핵심 교훈:** 대용량 데이터 처리 시 "전체 로딩" 방식은 피하고, 반드시 "청크 기반 스트리밍" 을 적용해야 함.

### 파일 리소스 관리 (Windows 특수성)
* **문제:** Windows 환경에서는 엑셀 파일을 읽는 도중 프로세스가 중단되면 파일 잠김(File Lock) 현상이 발생.
* **해결:** `finally` 블록에서 반드시 `wb.close()`를 호출하여 리소스 해제 보장.
* **핵심 교훈:** Windows에서는 파일 핸들 관리에 각별히 주의해야 하며, 제너레이터와 `try/finally` 조합이 가장 안전함.

### 헤드리스 테스트 환경
* **문제:** CI/CD(GitHub Actions) 및 헤드리스 환경에서는 GUI 컴포넌트 테스트 불가.
* **해결:** `unittest.mock`을 적극 활용하여 UI 컴포넌트와 클립보드 기능을 Mock 테스트. `QT_QPA_PLATFORM=offscreen` 환경 변수 설정.
* **핵심 교훈:** GUI 앱도 비즈니스 로직과 UI를 분리하면 헤드리스 테스트가 가능함.

### 클립보드 포맷
* **문제:** 여러 포맷(Plain Text, CSV, HTML)을 시도한 결과, 엑셀 붙여넣기 호환성에 차이가 있음.
* **해결:** Tab-Separated Values(TSV) 형식이 가장 안정적임을 확인.
* **핵심 교훈:** 클립보드 포맷은 대상 애플리케이션(Excel)의 입력 호환성을 우선으로 결정해야 함.

---

## v1.0.0 안정화 및 릴리즈 단계

### 로깅 시스템 도입의 중요성
* **문제:** `print()` 기반 디버깅은 프로덕션 환경에서 추적이 어렵고, 로그 파일이 무한히 커질 수 있음.
* **해결:** `logging` 모듈의 `RotatingFileHandler`(5MB × 3 백업)를 도입하여 파일 크기 자동 관리.
* **핵심 교훈:** 프로덕션 앱에서는 반드시 구조화된 로깅을 사용하고, 로그 로테이션을 설정해야 함.

### CI/CD 플랫폼 불일치
* **문제:** GitHub Actions가 `ubuntu-latest`에서 실행되나, 대상 플랫폼은 Windows. Nuitka 빌드 결과가 다를 수 있음.
* **미해결:** `windows-latest` 러너 추가가 필요하나 비용/속도 트레이드오프 존재.
* **핵심 교훈:** 대상 플랫폼과 CI/CD 환경을 일치시키는 것이 이상적이나, 현실적으로 불가능할 경우 최소한 단위 테스트라도 크로스 플랫폼으로 실행.

### 문서 동기화 실패 경험
* **문제:** Jules(이전 에이전트)에서 자동화로 v0.1 BETA → v1.0.0을 진행했으나, `.antigravityrules`와 `audit_roadmap.md`의 버전 갱신이 누락되어 문서 간 정합성이 깨짐.
* **해결:** 2026-02-17 Antigravity(D3D Protocol) 기반으로 전 문서를 일괄 동기화 수행.
* **핵심 교훈:** 에이전트가 변경될 때 문서 정합성 전체 감사(Audit)가 필수. D3D Protocol의 "문서 우선 원칙"과 "동기화 체크리스트"(§9)를 반드시 이행해야 함.

### Pandas 3.0 전환 시 주의사항
* **발견:** Pandas 3.0.0 (2026-01-21 릴리즈)에서 Copy-on-Write 시맨틱이 기본 활성화됨.
* **영향:** 기존 `df.iloc[...]= value` 등의 in-place 수정 패턴이 예상과 다르게 동작할 수 있음.
* **핵심 교훈:** 메이저 버전 업그레이드 시에는 반드시 릴리즈 노트를 확인하고, 기존 코드의 호환성을 그라운딩을 통해 검증해야 함.

---

## 종합 교훈 (프로젝트 DNA)

1. **문서가 코드보다 오래 산다.** 코드는 언제든 다시 쓸 수 있지만, 문서에 기록된 "왜(Why)"는 복구할 수 없다.
2. **에이전트가 바뀌면 감사가 필수다.** Jules → Antigravity 전환 시 문서 파편화가 발생함.
3. **방어적 코딩은 선택이 아닌 필수다.** Windows의 파일 잠김, 대용량 메모리 폭주, 정규식 오류 등을 항상 예상해야 함.
4. **그라운딩을 게을리하지 말 것.** 기술 스택의 최신 버전은 학습 데이터와 다를 수 있으므로, 항상 최신 정보를 확인.
5. **테스트와 로깅은 배포 전 반드시 갖춰야 할 최소한의 안전망이다.**
